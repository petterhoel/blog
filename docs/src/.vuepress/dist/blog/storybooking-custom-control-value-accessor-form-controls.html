<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Storybooking Custom Control Value Accessor Form Controls | Bits &amp;&amp; Pixels</title>
    <meta name="generator" content="VuePress 1.9.8">
    <link rel="icon" href="/assets/images/touch/icon.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="apple-touch-icon" href="/assets/images/touch/apple-touch-icon.png">
    <link rel="mask-icon" href="/assets/images/touch/icon.svg" color="#d4d8e6">
    <link rel="alternate" type="application/rss+xml" href="https://bitsnpixels.dev/rss.xml" title="Bits &amp;&amp; Pixels RSS Feed">
    <link rel="alternate" type="application/atom+xml" href="https://bitsnpixels.dev/feed.atom" title="Bits &amp;&amp; Pixels Atom Feed">
    <link rel="alternate" type="application/json" href="https://bitsnpixels.dev/feed.json" title="Bits &amp;&amp; Pixels JSON Feed">
    <meta name="description" content="Use Storybook.js with Angular Components that implements ControlValueAccessor">
    <meta name="theme-color" content="#fbfbff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="#fbfbff">
    <meta name="msapplication-TileImage" content="/assets/images/touch/icon-144x144.png">
    <meta name="msapplication-TileColor" content="#d4d8e6">
    
    <link rel="preload" href="/assets/css/0.styles.8e4c7566.css" as="style"><link rel="preload" href="/assets/js/app.f76b30db.js" as="script"><link rel="preload" href="/assets/js/2.2489a6ef.js" as="script"><link rel="preload" href="/assets/js/29.9043f45b.js" as="script"><link rel="preload" href="/assets/js/8.cb4e119b.js" as="script"><link rel="preload" href="/assets/js/3.79958784.js" as="script"><link rel="prefetch" href="/assets/js/10.8b739abc.js"><link rel="prefetch" href="/assets/js/11.c7033f6a.js"><link rel="prefetch" href="/assets/js/12.abafce8c.js"><link rel="prefetch" href="/assets/js/13.daffb00c.js"><link rel="prefetch" href="/assets/js/14.7b8f5cc9.js"><link rel="prefetch" href="/assets/js/15.7dce3d8c.js"><link rel="prefetch" href="/assets/js/16.630bd5eb.js"><link rel="prefetch" href="/assets/js/17.1d12062b.js"><link rel="prefetch" href="/assets/js/18.42fee5a0.js"><link rel="prefetch" href="/assets/js/19.53877b02.js"><link rel="prefetch" href="/assets/js/20.2eb95830.js"><link rel="prefetch" href="/assets/js/21.7c300813.js"><link rel="prefetch" href="/assets/js/22.0335ceec.js"><link rel="prefetch" href="/assets/js/23.4327f5bc.js"><link rel="prefetch" href="/assets/js/24.49564f76.js"><link rel="prefetch" href="/assets/js/25.96dbeebc.js"><link rel="prefetch" href="/assets/js/26.adec87ea.js"><link rel="prefetch" href="/assets/js/27.243c26b2.js"><link rel="prefetch" href="/assets/js/28.b39793c9.js"><link rel="prefetch" href="/assets/js/30.4d804c15.js"><link rel="prefetch" href="/assets/js/31.94cebda1.js"><link rel="prefetch" href="/assets/js/32.3b7cd58b.js"><link rel="prefetch" href="/assets/js/33.4ef44fef.js"><link rel="prefetch" href="/assets/js/34.c34f4d36.js"><link rel="prefetch" href="/assets/js/35.97c873c6.js"><link rel="prefetch" href="/assets/js/36.3045e56f.js"><link rel="prefetch" href="/assets/js/4.5bd48017.js"><link rel="prefetch" href="/assets/js/5.647c63bb.js"><link rel="prefetch" href="/assets/js/6.85fdeada.js"><link rel="prefetch" href="/assets/js/7.d186c6c4.js"><link rel="prefetch" href="/assets/js/9.17045ca4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8e4c7566.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/images/touch/icon.svg" alt="Bits &amp;&amp; Pixels" class="logo"> <span class="site-name can-hide">Bits &amp;&amp; Pixels</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link router-link-active">
  Blog
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  What's this?
</a></div> <a href="https://github.com/petterhoel/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link router-link-active">
  Blog
</a></div><div class="nav-item"><a href="/about/" class="nav-link">
  What's this?
</a></div> <a href="https://github.com/petterhoel/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="storybooking-custom-controlvalueaccessor-form-controls"><a href="#storybooking-custom-controlvalueaccessor-form-controls" class="header-anchor">#</a> Storybooking Custom ControlValueAccessor Form Controls</h1> <p>Sometimes it is really neat to implement custom form controls by implementing the <code>ControlValueAccessor</code> interface.</p> <p>We do wanna be able to develop and test them in isolation and there is  some small amount of setup needed to make them play along with Storybook. This is really about making a proper environment for these controls when they are spun up in isolation by storybook.</p> <p>Make sure storybook knows about <code>FormsModule</code>. In your <code>&lt;something&gt;.component.stories.ts</code> file</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// custom-form-control.component.stories.ts</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  title<span class="token operator">:</span> <span class="token string">'CustomFormControlComponent'</span><span class="token punctuation">,</span>
  component<span class="token operator">:</span> CustomFormControlComponent<span class="token punctuation">,</span>
  decorators<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token function">moduleMetadata</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      imports<span class="token operator">:</span> <span class="token punctuation">[</span>FormsModule<span class="token punctuation">]</span><span class="token punctuation">,</span> ðŸ‘ˆ
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">as</span> Meta<span class="token operator">&lt;</span>CustomFormControlComponent<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><p>We also need to tell storybook about <code>ngModelChange</code>. Add <code>ngModel</code> and <code>ngModelChange</code> to props. We keep previous args by spreading them.</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// custom-form-control.component.stories.ts</span>

<span class="token keyword">const</span> Template<span class="token operator">:</span> Story<span class="token operator">&lt;</span>CustomFormControlComponent<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">(</span>args<span class="token operator">:</span> CustomFormControlComponent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
    component<span class="token operator">:</span> CustomFormControlComponent<span class="token punctuation">,</span>
    props<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token operator">...</span>args<span class="token punctuation">,</span> ðŸ‘ˆ
        ngModel<span class="token operator">:</span> <span class="token string">'Type anything'</span><span class="token punctuation">,</span> ðŸ‘ˆ
        ngModelChange<span class="token operator">:</span> <span class="token function">action</span><span class="token punctuation">(</span><span class="token string">'ngModelChange'</span><span class="token punctuation">)</span> ðŸ‘ˆ
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>If addon-actions is not in your package.json already, install the package as a dev dependency.</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> <span class="token parameter variable">-D</span> @storybook/addon-actions
</code></pre></div><p>And break the habit of default <code>undefined</code> implementations of <code>onTouched</code> and <code>onChange</code> in your component so it may have a life outside an Angular form. Also, please consider having a typed value instead of <code>any</code>. This is just an example.</p> <div class="language-ts extra-class"><pre class="language-ts"><code>  <span class="token comment">// ðŸ˜¬ stop this nonsense</span>
  onTouched<span class="token operator">!</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  onChange<span class="token operator">!</span><span class="token operator">:</span> <span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>
  
  <span class="token comment">// ðŸ˜‡ provide an empty default implementation instead</span>
  <span class="token function-variable function">onChange</span> <span class="token operator">=</span> <span class="token punctuation">(</span>value<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function-variable function">onTouched</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"><aside id="external-resources" data-v-e9d35e9c><h2 data-v-e9d35e9c>External goodies ðŸ¥°</h2> <ul data-v-e9d35e9c><li data-v-e9d35e9c><a href="https://austingil.com/how-to-build-html-forms-right-semantics" target="_blank" rel="noopener noreferrer" data-v-e9d35e9c>Build Html Forms Right</a> By Austin Gil</li> <li data-v-e9d35e9c><a href="https://bhagesh.tech/trick-to-write-css-and-html-100x-faster" target="_blank" rel="noopener noreferrer" data-v-e9d35e9c>Emmet cheatcheet</a> By Bhagesh Hunakunti</li> <li data-v-e9d35e9c><a href="https://modern-web.dev" target="_blank" rel="noopener noreferrer" class="repo-link" data-v-e9d35e9c>Modern web</a>By modernweb-dev</li></ul></aside><!----></div></div>
    <script src="/assets/js/app.f76b30db.js" defer></script><script src="/assets/js/2.2489a6ef.js" defer></script><script src="/assets/js/29.9043f45b.js" defer></script><script src="/assets/js/8.cb4e119b.js" defer></script><script src="/assets/js/3.79958784.js" defer></script>
  </body>
</html>
